QUESTION 1 
-- Create the employees table
CREATE TABLE employees (
  employee_id INT PRIMARY KEY,
  name VARCHAR(50),
  department VARCHAR(50)
);

-- Create the sales table
CREATE TABLE sales (
  sale_id INT PRIMARY KEY,
  employee_id INT,
  sale_amount DECIMAL(10,2),
  sale_date DATE
);

-- Insert some sample data into the employees table
INSERT INTO employees (employee_id, name, department)
VALUES
  (1, 'John Doe', 'Sales'),
  (2, 'Jane Smith', 'Marketing'),
  (3, 'Bob Johnson', 'Sales'),
  (4, 'Sarah Lee', 'HR'),
  (5, 'Mike Brown', 'IT');

-- Insert some sample data into the sales table
INSERT INTO sales (sale_id, employee_id, sale_amount, sale_date)
VALUES
  (1, 1, 1000.00, '2022-01-01'),
  (2, 1, 500.00, '2022-01-05'),
  (3, 3, 750.00, '2022-01-10'),
  (4, 1, 250.00, '2022-01-15'),
  (5, 2, 1500.00, '2022-01-20');

 --list of employees that didn't make any sales
  SELECT e.name
FROM employees e
LEFT JOIN sales s
  ON e.employee_id = s.employee_id
WHERE s.employee_id IS NULL;

QUESTION 2
SELECT Country, COUNT(CustomerID) AS NumCustomers
FROM Customers
GROUP BY Country
HAVING COUNT(CustomerID) > 3
ORDER BY NumCustomers DESC;

QUESTION 3
CREATE PROCEDURE insert_or_update_employee
    @emp_id INT,
    @emp_name VARCHAR(50),
    @emp_email VARCHAR(100),
    @emp_department VARCHAR(50),
    @emp_salary DECIMAL(10, 2)
AS
BEGIN
    MERGE employees AS target
    USING (VALUES (@emp_id, @emp_name, @emp_email, @emp_department, @emp_salary)) AS source (emp_id, emp_name, emp_email, emp_department, emp_salary)
    ON target.emp_id = source.emp_id
    WHEN MATCHED THEN
        UPDATE SET emp_name = source.emp_name, emp_email = source.emp_email, emp_department = source.emp_department, emp_salary = source.emp_salary
    WHEN NOT MATCHED THEN
        INSERT (emp_id, emp_name, emp_email, emp_department, emp_salary)
        VALUES (source.emp_id, source.emp_name, source.emp_email, source.emp_department, source.emp_salary);
END;
To use this procedure, you can call it with the input values like this
EXEC insert_or_update_employee 1, 'John Doe', 'johndoe@example.com', 'Marketing', 50000.00;

QUESTION 4
CREATE TABLE EmployeeDetails (
    EmpId INT PRIMARY KEY,
    EmpName VARCHAR(50),
    EmpEmail VARCHAR(100),
    EmpDepartment VARCHAR(50),
    EmpSalary DECIMAL(10, 2)
);

INSERT INTO EmployeeDetails (EmpId, EmpName, EmpEmail, EmpDepartment, EmpSalary)
VALUES (1, 'John Doe', 'johndoe@example.com', 'Marketing', 50000.00),
       (2, 'Jane Smith', 'janesmith@example.com', 'Sales', 60000.00),
       (3, 'Bob Johnson', 'bobjohnson@example.com', 'HR', 55000.00),
       (4, 'John Doe', 'johndoe@example.com', 'Marketing', 50000.00),
       (5, 'Jane Smith', 'janesmith@example.com', 'Sales', 60000.00);

-- fetch duplicate records
SELECT EmpName, EmpEmail, EmpDepartment, EmpSalary, COUNT(*) AS NumDuplicates
FROM EmployeeDetails
GROUP BY EmpName, EmpEmail, EmpDepartment, EmpSalary
HAVING COUNT(*) > 1;

QUESTION 5
CREATE TABLE EmployeeDetails (
    EmpId INT PRIMARY KEY,
    EmpName VARCHAR(50),
    EmpEmail VARCHAR(100),
    EmpDepartment VARCHAR(50),
    EmpSalary DECIMAL(10, 2)
);

INSERT INTO EmployeeDetails (EmpId, EmpName, EmpEmail, EmpDepartment, EmpSalary)
VALUES (1, 'John Doe', 'johndoe@example.com', 'Marketing', 50000.00),
       (2, 'Jane Smith', 'janesmith@example.com', 'Sales', 60000.00),
       (3, 'Bob Johnson', 'bobjohnson@example.com', 'HR', 55000.00),
       (4, 'Mary Wilson', 'marywilson@example.com', 'Finance', 70000.00),
       (5, 'Tom Baker', 'tombaker@example.com', 'Marketing', 60000.00);

-- fetch only odd rows
SELECT *
FROM EmployeeDetails
WHERE EmpId % 2 = 1;
	
QUESTION 6
CREATE FUNCTION CalculateAge (@dob DATE)
RETURNS INT
AS
BEGIN
    DECLARE @age INT;
    SET @age = DATEDIFF(day, @dob, GETDATE()) / 365;
    RETURN @age;
END;
To use this function, you can call it with a date of birth like this
SELECT dbo.CalculateAge('1980-01-01');

